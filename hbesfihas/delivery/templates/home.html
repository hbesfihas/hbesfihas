<!DOCTYPE html>
{% load static %}
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cardápio</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <!-- Arquivo CSS personalizado -->
    <link rel="stylesheet" href="{% static 'css/custom.css' %}">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <!-- Logo -->
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="{% static 'imagens/logo.jpg' %}" alt="Logo" width="40" height="40" class="rounded-circle me-2">
                <span>HB Esfihas</span>
            </a>
            <!-- Botão para menu colapsado (em telas pequenas) -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!-- Links do menu -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#cardapio">Cardápio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#contato">Contato</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Conteúdo principal -->
    <div class="container mt-5">
        <h1 id="cardapio" class="text-center mb-4">Cardápio</h1>
        <div class="row">
            {% for produto in produtos %}
            <div class="col-md-4">
                <div class="product-card text-center">
                    <!-- Imagem do Produto -->
                    {% if produto.imagem %}
                    <img src="{{ produto.imagem.url }}" alt="{{ produto.nome }}" class="product-img mb-3">
                    {% else %}
                    <img src="{% static 'imagens/imagem_padrao.jpg' %}" alt="img" class="product-img mb-3">
                    {% endif %}
                    <!-- Nome do Produto -->
                    <div class="product-name">{{ produto.nome }}</div>

                    <!-- Descrição do Produto -->
                    <div class="product-description">{{ produto.descricao }}</div>

                    <!-- Preço do Produto -->
                    <div class="product-price">R$ {{ produto.preco|floatformat:2 }}</div>

                    <!-- Botões de quantidade -->
                    <div class="mt-3">
                        <button class="btn btn-success btn-sm add-btn" onclick="addItem(this)">+</button>
                        <span class="quantity d-none">
                            <span class="mx-2">0</span>
                            <button class="btn btn-danger btn-sm" onclick="removeItem(this)">-</button>
                        </span>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <div class="product-price" id="product-price-{{ produto.id }}">R$ {{ produto.preco|floatformat:2 }}</div>

    <!-- Subtotal -->
    <div id="subtotal" class="text-center mt-3">
        <strong>Subtotal: R$ 0,00 </strong>
    </div>       
    <div id="taxa-entrega" class="text-center mt-3">
        <strong>Taxa de Entrega: R$ 0,00</strong>
    </div>
    
    <div id="total" class="text-center mt-3">
        <strong>Total: R$ 0,00</strong>
    </div>
    <form method="post" action="{% url 'finalizar_pedido' %}">
            {% csrf_token %}
            <div class="mb-3">
                <label for="bairro" class="form-label">Bairro</label>
                <select name="bairro" id="bairro" class="form-select" onchange="updateTotal()" required>
                    <option value="" disabled selected>Selecione um bairro</option>
                    {% for bairro in bairros %}
                        <option value="{{ bairro.id }}" data-taxa="{{ bairro.taxa_entrega|floatformat:2|default:0 }}">{{ bairro.nome }} - R$ {{ bairro.taxa_entrega|floatformat:2 }}</option>
                    {% endfor %}
                </select>                
            </div>
            
            <div class="mb-3">
                <label for="endereco" class="form-label">Endereço</label>
                <textarea name="endereco" id="endereco" class="form-control" placeholder="Digite o endereço" rows="2" required></textarea>
            </div>
            <div class="mb-3">
                <label for="forma_pagamento" class="form-label">Forma de Pagamento</label>
                <select name="forma_pagamento" id="forma_pagamento" class="form-select" required>
                    <option value="dinheiro">Dinheiro</option>
                    <option value="pix">PIX</option>
                    <option value="cartaodebito">Cartão Débito</option>
                    <option value="cartaocredito">Cartão Crédito</option>
                </select>
            </div>
            <div class="mb-3">
                <button type="button" class="btn btn-outline-secondary" onclick="obterLocalizacao()">Obter Localização Atual</button>
                <input type="hidden" name="latitude" id="latitude">
                <input type="hidden" name="longitude" id="longitude">
            </div>
            <button type="submit" class="btn btn-success">Finalizar Pedido</button>
        </form>
    </div>
    <input type="hidden" name="subtotal" id="subtotal-value" value="0.00">
    <!-- Bootstrap JS -->
   
    <!-- JavaScript para controlar os botões -->
 <!-- Bootstrap JS -->
<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>

<!-- JavaScript para controlar os botões -->
<script src="{% static 'js/main.js' %}"></script>

</body>
</html>
